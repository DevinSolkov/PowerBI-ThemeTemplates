<?xml version="1.0" encoding="UTF-8"?>
<prompt name="Table Matrix Template Creation" version="1.0">
  <context>
    <repoRoot>.</repoRoot>
    <themeFile>2.Custom Themes/Rainwater Theme v4.1.calibri.json</themeFile>
    <schemaFile>reportThemeSchema-2.114.json</schemaFile>
    <styleCatalogCsv>_reports/table_matrix_style_attributes.csv</styleCatalogCsv>
    <styleCatalogJson>_reports/table_matrix_style_styles.json</styleCatalogJson>
    <styleReport>_reports/table_matrix_style_report.md</styleReport>
  </context>
  <objectives>
    <objective>Create distinct table and matrix style templates informed by catalog insights.</objective>
    <objective>Assign descriptive three-word names that convey look and feel for each template.</objective>
    <objective>Ensure generated templates conform to the Power BI theme schema and inherit Calibri font standards.</objective>
  </objectives>
  <milestones>
    <milestone id="1" title="Analyze existing style data">
      <inputs>
        <file>_reports/table_matrix_style_attributes.csv</file>
        <file>_reports/table_matrix_style_styles.json</file>
        <file>_reports/table_matrix_style_report.md</file>
      </inputs>
      <steps>
        <step>Identify unique table and matrix style variants along with their observed attributes.</step>
        <step>Group attributes by visual family (headers, grid, values, subtotals, etc.).</step>
        <step>Note signature characteristics that will drive creative naming.</step>
      </steps>
      <deliverables>
        <deliverable>Annotated attribute matrix highlighting differentiators per style.</deliverable>
      </deliverables>
      <acceptance>
        <criterion>Covers every catalog style variant for tables and matrices.</criterion>
        <criterion>Captures at least three defining traits per style.</criterion>
      </acceptance>
    </milestone>
    <milestone id="2" title="Design template metadata">
      <steps>
        <step>Draft a three-word descriptive name for each style capturing aesthetic and usage intent.</step>
        <step>Document intended use cases and attribute highlights for each template.</step>
        <step>Cross-check names for uniqueness and consistency.</step>
      </steps>
      <deliverables>
        <deliverable>_reports/table_matrix_template_manifest.json</deliverable>
        <deliverable>_reports/table_matrix_template_manifest.md</deliverable>
      </deliverables>
      <acceptance>
        <criterion>All names contain exactly three words and are unique.</criterion>
        <criterion>Manifest records rationale and key attributes for each template.</criterion>
      </acceptance>
    </milestone>
    <milestone id="3" title="Author theme templates">
      <inputs>
        <file>2.Custom Themes/Rainwater Theme v4.1.calibri.json</file>
        <file>reportThemeSchema-2.114.json</file>
      </inputs>
      <steps>
        <step>Create table and matrix visualStyles blocks using catalog-informed attributes as defaults.</step>
        <step>Embed three-word names via style metadata (e.g., name property) where schema permits.</step>
        <step>Validate JSON against the schema and ensure Calibri fonts remain consistent.</step>
        <step>Produce change log detailing attributes added per template.</step>
      </steps>
      <deliverables>
        <deliverable>2.Custom Themes/Rainwater TableMatrix Templates.json</deliverable>
        <deliverable>_reports/table_matrix_template_changes.csv</deliverable>
        <deliverable>_reports/table_matrix_template_validation.md</deliverable>
      </deliverables>
      <acceptance>
        <criterion>Schema validation passes with no errors.</criterion>
        <criterion>Each template includes all critical attribute families (headers, values, subtotals, grid/background as applicable).</criterion>
        <criterion>Fonts remain Calibri for all font-related keys.</criterion>
      </acceptance>
    </milestone>
  </milestones>
  <constraints>
    <constraint>Preserve original theme file as read-only; author new template variants in the dedicated output file.</constraint>
    <constraint>Maintain Calibri setting for all font keys.</constraint>
    <constraint>Document any assumptions or attribute substitutions in the validation report.</constraint>
  </constraints>
  <tools>
    <tool name="json_parser">Inspect and modify theme JSON structures.</tool>
    <tool name="csv_io">Aggregate attribute statistics from catalog data.</tool>
    <tool name="validator">Verify outputs against the official theme schema.</tool>
    <tool name="markdown_writer">Summarize findings and decisions for stakeholders.</tool>
  </tools>
  <outputs>
    <path>_reports/table_matrix_template_manifest.json</path>
    <path>_reports/table_matrix_template_manifest.md</path>
    <path>2.Custom Themes/Rainwater TableMatrix Templates.json</path>
    <path>_reports/table_matrix_template_changes.csv</path>
    <path>_reports/table_matrix_template_validation.md</path>
  </outputs>
  <successCriteria>
    <criterion>Deliverables enable direct reuse of table/matrix templates in future themes.</criterion>
    <criterion>Creative names and documentation provide clear guidance on aesthetic intent.</criterion>
    <criterion>Automation-ready artifacts facilitate further refinement or deployment.</criterion>
  </successCriteria>
</prompt>
